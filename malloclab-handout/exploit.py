#!/usr/bin/env python
from pwn import *

exe = "./mdriver"
elf = ELF(exe)
context.binary = elf

#libc = ELF('libc')
#ld = ELF('ld')

def start(argv=[], *a, **kw):
    command = sys.argv[1]
    if(command[0] != "-"):
        log.error("SyntaxErrorBitch: Care to add a '-' to the argument")
        exit(0)

    if(len(command) == 3 and command[2] == "i"):
        context.log_level = "debug"

    if(command[1] == "d"):
        return gdb.debug([exe] + argv, gdbscript=gdbscript, *a, **kw)
    elif(command[1] == "r"):
        return remote('addr',1234)
    elif(command[1] == "l"):
        return process([exe] + argv, *a, **kw)
    else:
        print("Woops! Somethin went wrong :/")

def s(a) : return io.send(a)
def sl(a) : return io.sendline(a)
def sa(a,b) : return io.sendafter(a,b)
def sla(a,b) : return io.sendlineafter(a,b)
def r(a) : return io.recv(a)
def ru(a) : return io.recvuntil(a)
def ra(a) : return io.recvall(a)
def rl() : return io.recvline()
def interactive() : return io.interactive()
def cls() : return io.close()
def p(a) : return log.info(a)
def suck(a) : return log.success(a)

gdbscript = '''
b mm_init
b mm_malloc
b mm_free
c

'''.format(**locals())

#==========================================================
'''
 _   _                 _    _        _____
| | | |               | |  | |      |  __ \
| |_| | ___ _ __ ___  | |  | | ___  | |  \/ ___
|  _  |/ _ \ '__/ _ \ | |/\| |/ _ \ | | __ / _ \
| | | |  __/ | |  __/ \  /\  /  __/ | |_\ \ (_) |  _   _   _
\_| |_/\___|_|  \___|  \/  \/ \___|  \____/\___/  (_) (_) (_)

'''

#==========================================================


io = start(["-V", "-f", "test.rep"])




interactive()
